<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>钓鱼系统 - 五大鱼池</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Microsoft YaHei', sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #1a2980, #26d0ce);
            color: #333;
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        header {
            text-align: center;
            padding: 20px 0;
            margin-bottom: 30px;
        }
        
        h1 {
            color: white;
            font-size: 2.8rem;
            text-shadow: 0 3px 6px rgba(0,0,0,0.3);
            margin-bottom: 10px;
        }
        
        .subtitle {
            color: #e0f7fa;
            font-size: 1.2rem;
            max-width: 600px;
            margin: 0 auto;
        }
        
        .tabs {
            display: flex;
            background: rgba(255, 255, 255, 0.85);
            border-radius: 15px 15px 0 0;
            overflow: hidden;
            margin-bottom: 0;
        }
        
        .tab {
            flex: 1;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            font-weight: bold;
            color: #1a2980;
            transition: all 0.3s;
        }
        
        .tab.active {
            background: #1a2980;
            color: white;
        }
        
        .content-area {
            background: rgba(255, 255, 255, 0.92);
            border-radius: 0 0 15px 15px;
            padding: 25px;
            min-height: 500px;
            box-shadow: 0 8px 16px rgba(0,0,0,0.2);
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .stats-bar {
            background: rgba(255, 255, 255, 0.85);
            border-radius: 15px;
            padding: 15px;
            margin-bottom: 25px;
            display: flex;
            justify-content: space-around;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }
        
        .stat-item {
            text-align: center;
        }
        
        .stat-label {
            font-size: 0.9rem;
            color: #666;
            margin-bottom: 5px;
        }
        
        .stat-value {
            font-size: 1.8rem;
            font-weight: bold;
            color: #1a2980;
        }
        
        .ponds-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .pond {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            box-shadow: 0 8px 16px rgba(0,0,0,0.2);
            padding: 20px;
            transition: transform 0.3s, box-shadow 0.3s;
            position: relative;
            overflow: hidden;
            cursor: pointer;
        }
        
        .pond:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 24px rgba(0,0,0,0.25);
        }
        
        .pond.selected {
            border: 3px solid #1a2980;
        }
        
        .pond-header {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #eee;
        }
        
        .pond-icon {
            width: 50px;
            height: 50px;
            margin-right: 15px;
            background-size: contain;
            background-repeat: no-repeat;
        }
        
        .pond-title {
            font-size: 1.5rem;
            font-weight: bold;
            color: #1a2980;
        }
        
        .fish-list {
            list-style-type: none;
            padding: 0;
            margin-bottom: 15px;
        }
        
        .fish-item {
            padding: 8px 12px;
            margin: 8px 0;
            background: rgba(30, 144, 255, 0.1);
            border-radius: 8px;
            display: flex;
            justify-content: space-between;
            transition: background 0.3s;
        }
        
        .fish-item:hover {
            background: rgba(30, 144, 255, 0.2);
        }
        
        .fish-name {
            font-weight: bold;
        }
        
        .fish-rarity {
            font-size: 0.85rem;
            padding: 2px 8px;
            border-radius: 10px;
            color: white;
        }
        
        .common { background: #4CAF50; }
        .uncommon { background: #2196F3; }
        .rare { background: #9C27B0; }
        .epic { background: #FF9800; }
        .legendary { background: #F44336; }
        
        .pond-footer {
            margin-top: 15px;
            padding-top: 10px;
            border-top: 1px solid #eee;
            font-size: 0.9rem;
            color: #666;
        }
        
        .water-effect {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 20px;
            background: rgba(30, 144, 255, 0.3);
            border-radius: 0 0 15px 15px;
        }
        
        .fishing-controls {
            display: flex;
            justify-content: space-between;
            margin-top: 15px;
        }
        
        .fish-btn {
            background: #1a2980;
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: bold;
            font-size: 1.1rem;
        }
        
        .fish-btn:hover {
            background: #26d0ce;
            transform: scale(1.05);
        }
        
        .fish-btn:disabled {
            background: #cccccc;
            cursor: not-allowed;
            transform: none;
        }
        
        .bait-count {
            display: flex;
            align-items: center;
            font-weight: bold;
            color: #1a2980;
            font-size: 1.1rem;
        }
        
        .bait-icon {
            width: 24px;
            height: 24px;
            margin-right: 5px;
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="%231a2980" d="M17,4C18.44,4 19.61,4.92 19.92,6.23L22,14.24C21.65,14.05 21.3,13.9 20.92,13.79L19,7.74C18.94,7.31 18.56,7 18.11,7H5.89C5.44,7 5.06,7.31 5,7.74L3.08,13.79C2.7,13.9 2.35,14.05 2,14.24L4.08,6.23C4.39,4.92 5.56,4 7,4H17M16.5,9C15.67,9 15,9.67 15,10.5C15,11.33 15.67,12 16.5,12C17.33,12 18,11.33 18,10.5C18,9.67 17.33,9 16.5,9M7,20C8.1,20 9,19.1 9,18C9,16.9 8.1,16 7,16C5.9,16 5,16.9 5,18C5,19.1 5.9,20 7,20M17,20C18.1,20 19,19.1 19,18C19,16.9 18.1,16 17,16C15.9,16 15,16.9 15,18C15,19.1 15.9,20 17,20Z"/></svg>');
        }
        
        .special-function {
            background: rgba(255, 255, 255, 0.85);
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            margin-bottom: 30px;
        }
        
        .special-title {
            color: #1a2980;
            margin-bottom: 15px;
            font-size: 1.4rem;
        }
        
        .input-group {
            display: flex;
            max-width: 500px;
            margin: 0 auto;
        }
        
        .magic-input {
            flex: 1;
            padding: 12px 15px;
            border: 2px solid #1a2980;
            border-radius: 25px 0 0 25px;
            font-size: 1rem;
            outline: none;
        }
        
        .magic-btn {
            background: #1a2980;
            color: white;
            border: none;
            padding: 0 25px;
            border-radius: 0 25px 25px 0;
            cursor: pointer;
            font-weight: bold;
            transition: background 0.3s;
        }
        
        .magic-btn:hover {
            background: #26d0ce;
        }
        
        .result-container {
            background: rgba(255, 255, 255, 0.92);
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            min-height: 150px;
            text-align: center;
        }
        
        .result-title {
            color: #1a2980;
            margin-bottom: 15px;
            font-size: 1.3rem;
        }
        
        .fish-result {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }
        
        .fish-image {
            width: 100px;
            height: 100px;
            margin-bottom: 15px;
            background-size: contain;
            background-repeat: no-repeat;
            background-position: center;
        }
        
        .fish-name-large {
            font-size: 1.5rem;
            font-weight: bold;
            color: #1a2980;
            margin-bottom: 5px;
        }
        
        .fish-info {
            font-size: 1.1rem;
            color: #666;
        }
        
        .infinite-mode {
            animation: infiniteGlow 2s infinite alternate;
        }
        
        @keyframes infiniteGlow {
            from { box-shadow: 0 0 5px #ffeb3b; }
            to { box-shadow: 0 0 20px #ffeb3b, 0 0 30px #ff9800; }
        }
        
        .fish-basket {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        
        .basket-fish {
            background: rgba(30, 144, 255, 0.1);
            border-radius: 10px;
            padding: 15px;
            text-align: center;
        }
        
        .basket-fish-count {
            font-size: 0.9rem;
            color: #666;
            margin-top: 5px;
        }
        
        .get-bait-btn {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-weight: bold;
            margin-top: 15px;
            transition: background 0.3s;
        }
        
        .get-bait-btn:hover {
            background: #45a049;
        }
        
        @media (max-width: 768px) {
            .ponds-container {
                grid-template-columns: 1fr;
            }
            
            .stats-bar {
                flex-direction: column;
                gap: 15px;
            }
            
            .input-group {
                flex-direction: column;
            }
            
            .magic-input {
                border-radius: 25px;
                margin-bottom: 10px;
            }
            
            .magic-btn {
                border-radius: 25px;
                padding: 12px;
            }
            
            .tabs {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>钓鱼系统</h1>
            <p class="subtitle">探索五大特色鱼池，捕获珍稀鱼类，体验钓鱼乐趣！</p>
        </header>
        
        <div class="stats-bar">
            <div class="stat-item">
                <div class="stat-label">当前鱼饵</div>
                <div class="stat-value" id="bait-count">20</div>
            </div>
            <div class="stat-item">
                <div class="stat-label">已钓到鱼类</div>
                <div class="stat-value" id="fish-count">0</div>
            </div>
            <div class="stat-item">
                <div class="stat-label">钓鱼次数</div>
                <div class="stat-value" id="fish-times">0</div>
            </div>
            <div class="stat-item">
                <div class="stat-label">当前等级</div>
                <div class="stat-value" id="player-level">1</div>
            </div>
        </div>
        
        <div class="tabs">
            <div class="tab active" data-tab="ponds">选择鱼池</div>
            <div class="tab" data-tab="fishing">开始钓鱼</div>
            <div class="tab" data-tab="basket">查看鱼笼</div>
            <div class="tab" data-tab="bait">获取鱼饵</div>
        </div>
        
        <div class="content-area">
            <!-- 选择鱼池标签 -->
            <div class="tab-content active" id="ponds-tab">
                <h2>选择鱼池</h2>
                <p>点击选择一个鱼池开始钓鱼：</p>
                
                <div class="ponds-container" id="ponds-list">
                    <!-- 鱼池将通过JavaScript动态生成 -->
                </div>
                
                <div class="special-function">
                    <h2 class="special-title">特殊功能</h2>
                    <div class="input-group">
                        <input type="text" class="magic-input" id="magic-input" placeholder="输入神秘咒语...">
                        <button class="magic-btn" onclick="activateMagic()">激活</button>
                    </div>
                </div>
            </div>
            
            <!-- 开始钓鱼标签 -->
            <div class="tab-content" id="fishing-tab">
                <h2>开始钓鱼</h2>
                <div id="selected-pond-info">
                    <p>请先在选择鱼池标签中选择一个鱼池</p>
                </div>
                
                <div class="fishing-controls">
                    <div class="bait-count">
                        <div class="bait-icon"></div>
                        <span>消耗: <span id="bait-cost">0</span> 鱼饵</span>
                    </div>
                    <button class="fish-btn" id="fish-btn" disabled>开始钓鱼</button>
                </div>
                
                <div class="result-container" id="result-container">
                    <h2 class="result-title">钓鱼结果</h2>
                    <div class="fish-result" id="fish-result">
                        <p>选择一个鱼池开始钓鱼吧！</p>
                    </div>
                </div>
            </div>
            
            <!-- 查看鱼笼标签 -->
            <div class="tab-content" id="basket-tab">
                <h2>我的鱼笼</h2>
                <p>这是您目前收集到的所有鱼类：</p>
                
                <div class="fish-basket" id="fish-basket">
                    <!-- 鱼类将通过JavaScript动态生成 -->
                </div>
            </div>
            
            <!-- 获取鱼饵标签 -->
            <div class="tab-content" id="bait-tab">
                <h2>获取鱼饵</h2>
                <p>您可以通过以下方式获取鱼饵：</p>
                
                <div style="margin-top: 20px;">
                    <h3>每日登录奖励</h3>
                    <p>每日首次登录可获得 <strong>5个鱼饵</strong></p>
                    <button class="get-bait-btn" onclick="getDailyBait()">领取今日鱼饵</button>
                </div>
                
                <div style="margin-top: 30px;">
                    <h3>任务奖励</h3>
                    <p>完成以下任务可获得鱼饵：</p>
                    <ul style="margin-top: 10px; margin-left: 20px;">
                        <li>首次钓鱼：+3鱼饵</li>
                        <li>钓到稀有鱼：+2鱼饵</li>
                        <li>达到5级：+10鱼饵</li>
                    </ul>
                </div>
                
                <div style="margin-top: 30px;">
                    <h3>自动恢复</h3>
                    <p>每5分钟自动恢复 <strong>1个鱼饵</strong></p>
                    <p id="next-recovery">下次恢复: 计算中...</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // 鱼池数据
        const ponds = [
            {
                id: 0,
                name: "清泉湖",
                description: "平静水域，适合新手钓鱼",
                baitCost: 1,
                fish: [
                    { name: "鲤鱼", rarity: "common", weight: 40 },
                    { name: "鲫鱼", rarity: "common", weight: 35 },
                    { name: "草鱼", rarity: "common", weight: 30 },
                    { name: "青鱼", rarity: "uncommon", weight: 15 },
                    { name: "银龙鱼", rarity: "rare", weight: 5 }
                ]
            },
            {
                id: 1,
                name: "激流溪",
                description: "水流湍急，需要技巧",
                baitCost: 2,
                fish: [
                    { name: "溪哥", rarity: "common", weight: 35 },
                    { name: "虹鳟鱼", rarity: "uncommon", weight: 30 },
                    { name: "马口鱼", rarity: "uncommon", weight: 20 },
                    { name: "鲑鱼", rarity: "rare", weight: 10 },
                    { name: "金鳟王", rarity: "epic", weight: 5 }
                ]
            },
            {
                id: 2,
                name: "深海湾",
                description: "深海区域，有大型鱼类",
                baitCost: 3,
                fish: [
                    { name: "带鱼", rarity: "common", weight: 30 },
                    { name: "石斑鱼", rarity: "uncommon", weight: 25 },
                    { name: "金枪鱼", rarity: "rare", weight: 20 },
                    { name: "旗鱼", rarity: "epic", weight: 15 },
                    { name: "深海巨鳗", rarity: "legendary", weight: 10 }
                ]
            },
            {
                id: 3,
                name: "荷花塘",
                description: "荷花环绕，有珍稀观赏鱼",
                baitCost: 2,
                fish: [
                    { name: "泥鳅", rarity: "common", weight: 35 },
                    { name: "黄鳝", rarity: "uncommon", weight: 30 },
                    { name: "锦鲤", rarity: "rare", weight: 20 },
                    { name: "金蟾", rarity: "epic", weight: 10 },
                    { name: "七彩神仙鱼", rarity: "legendary", weight: 5 }
                ]
            },
            {
                id: 4,
                name: "冰封湖",
                description: "寒冷水域，需要特殊装备",
                baitCost: 3,
                fish: [
                    { name: "冰鲈鱼", rarity: "common", weight: 35 },
                    { name: "北极鳕鱼", rarity: "uncommon", weight: 30 },
                    { name: "雪鱼", rarity: "rare", weight: 20 },
                    { name: "寒冰龙鱼", rarity: "epic", weight: 10 },
                    { name: "冰晶凤凰鱼", rarity: "legendary", weight: 5 }
                ]
            }
        ];
        
        // 游戏状态
        let gameState = {
            bait: 20,
            fishCaught: 0,
            fishingTimes: 0,
            playerLevel: 1,
            infiniteMode: false,
            selectedPond: null,
            fishBasket: {},
            lastDailyBait: null
        };
        
        // 初始化函数
        function init() {
            // 从本地存储加载游戏状态
            const savedState = localStorage.getItem('fishingGameState');
            if (savedState) {
                const parsed = JSON.parse(savedState);
                gameState = { ...gameState, ...parsed };
            }
            
            // 检查是否可以领取每日鱼饵
            checkDailyBait();
            
            // 渲染鱼池列表
            renderPonds();
            
            // 更新状态显示
            updateStats();
            
            // 设置标签切换事件
            setupTabs();
            
            // 设置自动恢复计时器
            setInterval(updateRecoveryTimer, 1000);
        }
        
        // 渲染鱼池列表
        function renderPonds() {
            const pondsContainer = document.getElementById('ponds-list');
            pondsContainer.innerHTML = '';
            
            ponds.forEach(pond => {
                const pondElement = document.createElement('div');
                pondElement.className = `pond ${gameState.selectedPond === pond.id ? 'selected' : ''}`;
                pondElement.onclick = () => selectPond(pond.id);
                
                const rarityText = {
                    common: "常见",
                    uncommon: "少见",
                    rare: "稀有",
                    epic: "史诗",
                    legendary: "传说"
                };
                
                pondElement.innerHTML = `
                    <div class="pond-header">
                        <div class="pond-icon" style="background-image: url('data:image/svg+xml;utf8,<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\"><path fill=\"%231a2980\" d=\"M12,2C6.48,2,2,6.48,2,12s4.48,10,10,10s10-4.48,10-10S17.52,2,12,2z M12,20c-4.41,0-8-3.59-8-8s3.59-8,8-8 s8,3.59,8,8S16.41,20,12,20z M17,10h-2V7h-2v3H7v2h3v3h2v-3h3V10z\"/></svg>')"></div>
                        <h2 class="pond-title">${pond.name}</h2>
                    </div>
                    <ul class="fish-list">
                        ${pond.fish.map(fish => `
                            <li class="fish-item">
                                <span class="fish-name">${fish.name}</span>
                                <span class="fish-rarity ${fish.rarity}">${rarityText[fish.rarity]}</span>
                            </li>
                        `).join('')}
                    </ul>
                    <div class="pond-footer">
                        <strong>特性:</strong> ${pond.description}
                    </div>
                    <div class="water-effect"></div>
                `;
                
                pondsContainer.appendChild(pondElement);
            });
        }
        
        // 选择鱼池
        function selectPond(pondId) {
            gameState.selectedPond = pondId;
            renderPonds();
            
            // 更新钓鱼标签中的信息
            const pond = ponds[pondId];
            document.getElementById('selected-pond-info').innerHTML = `
                <h3>当前选择: ${pond.name}</h3>
                <p>${pond.description}</p>
                <p>消耗鱼饵: ${pond.baitCost}个</p>
            `;
            
            document.getElementById('bait-cost').textContent = pond.baitCost;
            
            // 启用或禁用钓鱼按钮
            const fishBtn = document.getElementById('fish-btn');
            if (gameState.infiniteMode || gameState.bait >= pond.baitCost) {
                fishBtn.disabled = false;
                fishBtn.textContent = '开始钓鱼';
            } else {
                fishBtn.disabled = true;
                fishBtn.textContent = '鱼饵不足';
            }
            
            // 切换到钓鱼标签
            switchTab('fishing');
        }
        
        // 钓鱼功能
        function fish() {
            if (gameState.selectedPond === null) {
                showResult("请先选择鱼池", "在选择鱼池标签中选择一个鱼池");
                return;
            }
            
            const pond = ponds[gameState.selectedPond];
            
            // 检查鱼饵
            if (!gameState.infiniteMode && gameState.bait < pond.baitCost) {
                showResult("鱼饵不足！", "请获取更多鱼饵");
                return;
            }
            
            // 消耗鱼饵
            if (!gameState.infiniteMode) {
                gameState.bait -= pond.baitCost;
            }
            
            // 增加钓鱼次数
            gameState.fishingTimes++;
            
            // 更新玩家等级
            updatePlayerLevel();
            
            // 随机选择鱼类
            const totalWeight = pond.fish.reduce((sum, fish) => sum + fish.weight, 0);
            let random = Math.random() * totalWeight;
            
            let caughtFish = null;
            for (const fish of pond.fish) {
                random -= fish.weight;
                if (random <= 0) {
                    caughtFish = fish;
                    break;
                }
            }
            
            // 增加捕获计数
            gameState.fishCaught++;
            
            // 添加到鱼笼
            if (!gameState.fishBasket[caughtFish.name]) {
                gameState.fishBasket[caughtFish.name] = 0;
            }
            gameState.fishBasket[caughtFish.name]++;
            
            // 显示结果
            showFishResult(pond, caughtFish);
            
            // 更新状态
            updateStats();
            
            // 保存游戏状态
            saveGameState();
        }
        
        // 更新玩家等级
        function updatePlayerLevel() {
            const newLevel = Math.min(10, Math.floor(gameState.fishingTimes / 10) + 1);
            if (newLevel > gameState.playerLevel) {
                gameState.playerLevel = newLevel;
                // 等级提升奖励
                if (newLevel === 5) {
                    gameState.bait += 10;
                    showResult(`恭喜达到${newLevel}级！`, "获得10个鱼饵奖励！");
                }
            }
        }
        
        // 显示钓鱼结果
        function showFishResult(pond, fish) {
            const resultDiv = document.getElementById('fish-result');
            const rarityClass = fish.rarity;
            const rarityText = {
                common: "常见",
                uncommon: "少见",
                rare: "稀有",
                epic: "史诗",
                legendary: "传说"
            }[fish.rarity];
            
            // 创建鱼类SVG图标
            const fishSVG = `
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 50" width="100" height="50">
                    <path fill="#1a2980" d="M10,25 Q30,10 50,25 T90,25" />
                    <path fill="#1a2980" d="M10,25 Q30,40 50,25 T90,25" />
                    <circle cx="75" cy="25" r="3" fill="white" />
                    <path d="M5,20 L15,25 L5,30 Z" fill="#1a2980" />
                </svg>
            `;
            
            resultDiv.innerHTML = `
                <div class="fish-image">${fishSVG}</div>
                <div class="fish-name-large">${fish.name}</div>
                <div class="fish-rarity ${rarityClass}">${rarityText}</div>
                <div class="fish-info">在 ${pond.name} 捕获</div>
            `;
            
            // 根据稀有度添加动画效果
            if (fish.rarity === 'epic' || fish.rarity === 'legendary') {
                resultDiv.innerHTML += `<div class="fish-info">恭喜钓到珍稀鱼类！</div>`;
            }
        }
        
        // 显示文本结果
        function showResult(title, message) {
            const resultDiv = document.getElementById('fish-result');
            resultDiv.innerHTML = `
                <h3>${title}</h3>
                <p>${message}</p>
            `;
        }
        
        // 激活特殊功能
        function activateMagic() {
            const input = document.getElementById('magic-input').value;
            if (input.toLowerCase() === "谢谢ai小官") {
                gameState.infiniteMode = true;
                document.getElementById('result-container').classList.add('infinite-mode');
                showResult("鱼儿无限模式激活！", "现在钓鱼不再消耗鱼饵");
                updateStats();
                saveGameState();
            } else {
                showResult("咒语无效", "请尝试其他咒语");
            }
        }
        
        // 获取每日鱼饵
        function getDailyBait() {
            const today = new Date().toDateString();
            if (gameState.lastDailyBait === today) {
                showResult("今日已领取", "请明天再来领取每日鱼饵");
                return;
            }
            
            gameState.bait += 5;
            gameState.lastDailyBait = today;
            updateStats();
            saveGameState();
            
            showResult("领取成功！", "获得5个鱼饵");
        }
        
        // 检查每日鱼饵
        function checkDailyBait() {
            const today = new Date().toDateString();
            if (gameState.lastDailyBait !== today) {
                // 可以领取今日鱼饵
                document.querySelector('.get-bait-btn').disabled = false;
                document.querySelector('.get-bait-btn').textContent = '领取今日鱼饵';
            } else {
                document.querySelector('.get-bait-btn').disabled = true;
                document.querySelector('.get-bait-btn').textContent = '今日已领取';
            }
        }
        
        // 更新恢复计时器
        function updateRecoveryTimer() {
            // 简化版：每5分钟恢复1个鱼饵
            const now = new Date();
            const minutes = now.getMinutes();
            
            if (minutes % 5 === 0 && now.getSeconds() === 0 && !gameState.infiniteMode) {
                gameState.bait += 1;
                updateStats();
                saveGameState();
            }
            
            // 计算下次恢复时间
            const nextRecovery = 5 - (minutes % 5);
            document.getElementById('next-recovery').textContent = `下次恢复: ${nextRecovery}分钟后`;
        }
        
        // 更新状态显示
        function updateStats() {
            document.getElementById('bait-count').textContent = gameState.infiniteMode ? '∞' : gameState.bait;
            document.getElementById('fish-count').textContent = gameState.fishCaught;
            document.getElementById('fish-times').textContent = gameState.fishingTimes;
            document.getElementById('player-level').textContent = gameState.playerLevel;
        }
        
        // 设置标签切换
        function setupTabs() {
            const tabs = document.querySelectorAll('.tab');
            tabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    const tabName = tab.getAttribute('data-tab');
                    switchTab(tabName);
                });
            });
            
            // 设置钓鱼按钮
            document.getElementById('fish-btn').addEventListener('click', fish);
        }
        
        // 切换标签
        function switchTab(tabName) {
            // 移除所有active类
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            
            // 添加active类到当前标签
            document.querySelector(`.tab[data-tab="${tabName}"]`).classList.add('active');
            document.getElementById(`${tabName}-tab`).classList.add('active');
            
            // 如果是鱼笼标签，更新鱼笼显示
            if (tabName === 'basket') {
                updateFishBasket();
            }
        }
        
        // 更新鱼笼显示
        function updateFishBasket() {
            const basket = document.getElementById('fish-basket');
            basket.innerHTML = '';
            
            if (Object.keys(gameState.fishBasket).length === 0) {
                basket.innerHTML = '<p>您的鱼笼还是空的，快去钓鱼吧！</p>';
                return;
            }
            
            for (const [fishName, count] of Object.entries(gameState.fishBasket)) {
                const fishElement = document.createElement('div');
                fishElement.className = 'basket-fish';
                fishElement.innerHTML = `
                    <div class="fish-name">${fishName}</div>
                    <div class="basket-fish-count">数量: ${count}</div>
                `;
                basket.appendChild(fishElement);
            }
        }
        
        // 保存游戏状态
        function saveGameState() {
            localStorage.setItem('fishingGameState', JSON.stringify(gameState));
        }
        
        // 初始化游戏
        window.onload = init;
    </script>
</body>
</html>
